var qe=Object.defineProperty;var Xe=(s,e,t)=>e in s?qe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var P=(s,e,t)=>(Xe(s,typeof e!="symbol"?e+"":e,t),t);import{r as g,e as B,_ as Ge,f as z,g as Ke,h as Ye,i as Je,R as Q,I as ee,k as O,m as Ze,l as V,n as Qe,o as et,A as le,j as h,p as D,c as W,T as F,C as Y,B as ce,F as R,q as tt,s as J,d as M,a as $,t as it,v as nt,b as je,w as st,M as rt}from"./index-204de1e1.js";import{M as q}from"./Menu-0b5c7ecd.js";import{S as ot}from"./Popover-b42aea45.js";function at(s,e){try{return JSON.stringify(s)}catch{throw new Error(`@mantine/hooks ${e}: Failed to serialize the value`)}}function lt(s){try{return JSON.parse(s)}catch{return s}}function ct(s,e){const t=s==="localStorage"?"mantine-local-storage":"mantine-session-storage";return function({key:n,defaultValue:r=void 0,getInitialValueInEffect:o=!0,deserialize:a=lt,serialize:l=d=>at(d,e)}){const d=g.useCallback(p=>{if(typeof window>"u"||!(s in window)||window[s]===null||p)return r;const y=window[s].getItem(n);return y!==null?a(y):r},[n,r]),[c,u]=g.useState(d(o)),m=g.useCallback(p=>{p instanceof Function?u(y=>{const x=p(y);return window[s].setItem(n,l(x)),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:p(y)}})),x}):(window[s].setItem(n,l(p)),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:p}})),u(p))},[n]),v=g.useCallback(()=>{window[s].removeItem(n),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:r}}))},[]);return B("storage",p=>{var y;p.storageArea===window[s]&&p.key===n&&u(a((y=p.newValue)!=null?y:void 0))}),B(t,p=>{p.detail.key===n&&u(p.detail.value)}),g.useEffect(()=>{r!==void 0&&c===void 0&&m(r)},[r,c,m]),g.useEffect(()=>{o&&u(d())},[n]),[c===void 0?r:c,m,v]}}function dt(s){return ct("localStorage","use-local-storage")(s)}function ht(s=!1,e){const{onOpen:t,onClose:i}=e||{},[n,r]=g.useState(s),o=g.useCallback(()=>{r(d=>d||(t==null||t(),!0))},[t]),a=g.useCallback(()=>{r(d=>d&&(i==null||i(),!1))},[i]),l=g.useCallback(()=>{n?a():o()},[a,o,n]);return[n,{open:o,close:a,toggle:l}]}function ut(s,e){if(s==null)return{};var t={},i=Object.keys(s),n,r;for(r=0;r<i.length;r++)n=i[r],!(e.indexOf(n)>=0)&&(t[n]=s[n]);return t}var pt=g.useLayoutEffect,mt=function(e){var t=g.useRef(e);return pt(function(){t.current=e}),t},me=function(e,t){if(typeof e=="function"){e(t);return}e.current=t},gt=function(e,t){var i=g.useRef();return g.useCallback(function(n){e.current=n,i.current&&me(i.current,null),i.current=t,t&&me(t,n)},[t])},ge={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},fe=function(e){Object.keys(ge).forEach(function(t){e.style.setProperty(t,ge[t],"important")})},T=null,ft=function(e,t){var i=e.scrollHeight;return t.sizingStyle.boxSizing==="border-box"?i+t.borderSize:i-t.paddingSize};function vt(s,e,t,i){t===void 0&&(t=1),i===void 0&&(i=1/0),T||(T=document.createElement("textarea"),T.setAttribute("tabindex","-1"),T.setAttribute("aria-hidden","true"),fe(T)),T.parentNode===null&&document.body.appendChild(T);var n=s.paddingSize,r=s.borderSize,o=s.sizingStyle,a=o.boxSizing;Object.keys(o).forEach(function(m){var v=m;T.style[v]=o[v]}),fe(T),T.value=e;var l=ft(T,s);T.value="x";var d=T.scrollHeight-n,c=d*t;a==="border-box"&&(c=c+n+r),l=Math.max(c,l);var u=d*i;return a==="border-box"&&(u=u+n+r),l=Math.min(u,l),[l,d]}var ve=function(){},bt=function(e,t){return e.reduce(function(i,n){return i[n]=t[n],i},{})},yt=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],xt=!!document.documentElement.currentStyle,wt=function(e){var t=window.getComputedStyle(e);if(t===null)return null;var i=bt(yt,t),n=i.boxSizing;if(n==="")return null;xt&&n==="border-box"&&(i.width=parseFloat(i.width)+parseFloat(i.borderRightWidth)+parseFloat(i.borderLeftWidth)+parseFloat(i.paddingRight)+parseFloat(i.paddingLeft)+"px");var r=parseFloat(i.paddingBottom)+parseFloat(i.paddingTop),o=parseFloat(i.borderBottomWidth)+parseFloat(i.borderTopWidth);return{sizingStyle:i,paddingSize:r,borderSize:o}},Ct=function(e){var t=mt(e);g.useLayoutEffect(function(){var i=function(r){t.current(r)};return window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}},[])},kt=function(e,t){var i=e.cacheMeasurements,n=e.maxRows,r=e.minRows,o=e.onChange,a=o===void 0?ve:o,l=e.onHeightChange,d=l===void 0?ve:l,c=ut(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),u=c.value!==void 0,m=g.useRef(null),v=gt(m,t),p=g.useRef(0),y=g.useRef(),x=function(){var C=m.current,w=i&&y.current?y.current:wt(C);if(w){y.current=w;var S=vt(w,C.value||C.placeholder||"x",r,n),E=S[0],j=S[1];p.current!==E&&(p.current=E,C.style.setProperty("height",E+"px","important"),d(E,{rowHeight:j}))}},b=function(C){u||x(),a(C)};return g.useLayoutEffect(x),Ct(x),g.createElement("textarea",Ge({},c,{onChange:b,ref:v}))},St=g.forwardRef(kt);const Et=St;var jt=z(s=>({input:{paddingTop:s.spacing.xs,paddingBottom:s.spacing.xs}}));const Tt=jt;var Rt=Object.defineProperty,Dt=Object.defineProperties,Lt=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,be=(s,e,t)=>e in s?Rt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,I=(s,e)=>{for(var t in e||(e={}))Te.call(e,t)&&be(s,t,e[t]);if(K)for(var t of K(e))Re.call(e,t)&&be(s,t,e[t]);return s},te=(s,e)=>Dt(s,Lt(e)),Pt=(s,e)=>{var t={};for(var i in s)Te.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&K)for(var i of K(s))e.indexOf(i)<0&&Re.call(s,i)&&(t[i]=s[i]);return t};const Mt={autosize:!1,size:"sm",__staticSelector:"Textarea"},De=g.forwardRef((s,e)=>{const t=Ke("Textarea",Mt,s),{autosize:i,maxRows:n,minRows:r,label:o,error:a,description:l,id:d,className:c,required:u,style:m,wrapperProps:v,classNames:p,styles:y,size:x,__staticSelector:b,sx:f,errorProps:C,descriptionProps:w,labelProps:S,inputWrapperOrder:E,inputContainer:j,unstyled:L,withAsterisk:_,variant:A}=t,Ie=Pt(t,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled","withAsterisk","variant"]),ue=Ye(d),{classes:Be,cx:He}=Tt(),{systemStyles:Ve,rest:Ue}=Je(Ie),pe=I({required:u,ref:e,error:a,id:ue,classNames:te(I({},p),{input:He(Be.input,p==null?void 0:p.input)}),styles:y,__staticSelector:b,size:x,multiline:!0,unstyled:L,variant:A},Ue);return Q.createElement(ee.Wrapper,I(I({label:o,error:a,id:ue,description:l,required:u,style:m,className:c,classNames:p,styles:y,size:x,__staticSelector:b,sx:f,errorProps:C,labelProps:S,descriptionProps:w,inputContainer:j,inputWrapperOrder:E,unstyled:L,withAsterisk:_,variant:A},Ve),v),i?Q.createElement(ee,te(I({},pe),{component:Et,maxRows:n,minRows:r})):Q.createElement(ee,te(I({},pe),{component:"textarea",rows:r})))});De.displayName="@mantine/core/Textarea";const Ot=O("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),zt=O("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Wt=O("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ft=O("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),$t=O("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),Nt=O("Volume1",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}]]),_t=O("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),At=O("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),It=O("Volume",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}]]);class Bt{constructor(){P(this,"fragment");P(this,"clearFragment",()=>{this.fragment=void 0});P(this,"setFragment",e=>{e&&(this.fragment={...e})});P(this,"setTrb",e=>{this.fragment&&(this.fragment.trb=e)});P(this,"valid",!1);P(this,"setValid",e=>{this.valid=e});P(this,"selectedLabel",{label:"",color:""});P(this,"setSelectedLabel",e=>{this.selectedLabel=e});P(this,"labels",[]);P(this,"setLabels",e=>{this.labels=e});Ze(this)}}const N=new Bt;function Ht(){return V.post(`${le.fragmentTask}`)}function re(s,e){return V.post(Qe(s),{trb:e})}function oe(s,e){return V.post(et(s),{valid:e})}function ye(s,e){return V.post(`${le.fragmentClassify}/${s}`,{label:e})}function Vt(s,e){return V.post(`${le.fragmentLabeling}/${s}`,{label:e})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function k(s,e,t,i){return new(t||(t=Promise))(function(n,r){function o(d){try{l(i.next(d))}catch(c){r(c)}}function a(d){try{l(i.throw(d))}catch(c){r(c)}}function l(d){var c;d.done?n(d.value):(c=d.value,c instanceof t?c:new t(function(u){u(c)})).then(o,a)}l((i=i.apply(s,e||[])).next())})}let U=class{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i==null?void 0:i.once){const n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}};const xe={decode:function(s,e){return k(this,void 0,void 0,function*(){const t=new AudioContext({sampleRate:e});return t.decodeAudioData(s).finally(()=>t.close())})},createBuffer:function(s,e){return typeof s[0]=="number"&&(s=[s]),function(t){const i=t[0];if(i.some(n=>n>1||n<-1)){const n=i.length;let r=0;for(let o=0;o<n;o++){const a=Math.abs(i[o]);a>r&&(r=a)}for(const o of t)for(let a=0;a<n;a++)o[a]/=r}}(s),{duration:e,length:s[0].length,sampleRate:s[0].length/e,numberOfChannels:s.length,getChannelData:t=>s==null?void 0:s[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Le(s,e){const t=e.xmlns?document.createElementNS(e.xmlns,s):document.createElement(s);for(const[i,n]of Object.entries(e))if(i==="children")for(const[r,o]of Object.entries(e))typeof o=="string"?t.appendChild(document.createTextNode(o)):t.appendChild(Le(r,o));else i==="style"?Object.assign(t.style,n):i==="textContent"?t.textContent=n:t.setAttribute(i,n.toString());return t}function we(s,e,t){const i=Le(s,e||{});return t==null||t.appendChild(i),i}var Ut=Object.freeze({__proto__:null,createElement:we,default:we});const qt={fetchBlob:function(s,e,t){return k(this,void 0,void 0,function*(){const i=yield fetch(s,t);if(i.status>=400)throw new Error(`Failed to fetch ${s}: ${i.status} (${i.statusText})`);return function(n,r){k(this,void 0,void 0,function*(){if(!n.body||!n.headers)return;const o=n.body.getReader(),a=Number(n.headers.get("Content-Length"))||0;let l=0;const d=u=>k(this,void 0,void 0,function*(){l+=(u==null?void 0:u.length)||0;const m=Math.round(l/a*100);r(m)}),c=()=>k(this,void 0,void 0,function*(){let u;try{u=yield o.read()}catch{return}u.done||(d(u.value),yield c())});c()})}(i.clone(),e),i.blob()})}};let Xt=class extends U{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onceMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)})}onMediaEvent(e,t,i){return this.media.addEventListener(e,t,i),()=>this.media.removeEventListener(e,t)}onceMediaEvent(e,t){return this.onMediaEvent(e,t,{once:!0})}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,t){if(this.getSrc()===e)return;this.revokeSrc();const i=t instanceof Blob&&this.canPlayType(t.type)?URL.createObjectURL(t):e;this.media.src=i}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return k(this,void 0,void 0,function*(){if(this.media.src)return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}};class Z extends U{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.options=e;const i=this.parentFromOptionsContainer(e.container);this.parent=i;const[n,r]=this.initHtml();i.appendChild(n),this.container=n,this.scrollContainer=r.querySelector(".scroll"),this.wrapper=r.querySelector(".wrapper"),this.canvasWrapper=r.querySelector(".canvases"),this.progressWrapper=r.querySelector(".progress"),this.cursor=r.querySelector(".cursor"),t&&r.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){const e=i=>{const n=this.wrapper.getBoundingClientRect(),r=i.clientX-n.left,o=i.clientX-n.left;return[r/n.width,o/n.height]};this.wrapper.addEventListener("click",i=>{const[n,r]=e(i);this.emit("click",n,r)}),this.wrapper.addEventListener("dblclick",i=>{const[n,r]=e(i);this.emit("dblclick",n,r)}),this.options.dragToSeek&&this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:i,scrollWidth:n,clientWidth:r}=this.scrollContainer,o=i/n,a=(i+r)/n;this.emit("scroll",o,a)});const t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){(function(e,t,i,n,r=3,o=0){if(!e)return()=>{};let a=()=>{};const l=d=>{if(d.button!==o)return;d.preventDefault(),d.stopPropagation();let c=d.clientX,u=d.clientY,m=!1;const v=f=>{f.preventDefault(),f.stopPropagation();const C=f.clientX,w=f.clientY,S=C-c,E=w-u;if(m||Math.abs(S)>r||Math.abs(E)>r){const j=e.getBoundingClientRect(),{left:L,top:_}=j;m||(i==null||i(c-L,u-_),m=!0),t(S,E,C-L,w-_),c=C,u=w}},p=()=>{m&&(n==null||n()),a()},y=f=>{f.relatedTarget&&f.relatedTarget!==document.documentElement||p()},x=f=>{m&&(f.stopPropagation(),f.preventDefault())},b=f=>{m&&f.preventDefault()};document.addEventListener("pointermove",v),document.addEventListener("pointerup",p),document.addEventListener("pointerout",y),document.addEventListener("pointercancel",y),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("click",x,{capture:!0}),a=()=>{document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",p),document.removeEventListener("pointerout",y),document.removeEventListener("pointercancel",y),document.removeEventListener("touchmove",b),setTimeout(()=>{document.removeEventListener("click",x,{capture:!0})},10)}};e.addEventListener("pointerdown",l)})(this.wrapper,(e,t,i)=>{this.emit("drag",Math.max(0,Math.min(1,i/this.wrapper.getBoundingClientRect().width)))},()=>this.isDragging=!0,()=>this.isDragging=!1)}getHeight(e){return e==null?128:isNaN(Number(e))?e==="auto"&&this.parent.clientHeight||128:Number(e)}initHtml(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"});return t.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){const t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek&&!this.options.dragToSeek&&this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:t}=this.scrollContainer,i=t*e;this.setScroll(i)}destroy(){var e;this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect()}createDelay(e=10){let t,i;const n=()=>{t&&clearTimeout(t),i&&i()};return this.timeouts.push(n),()=>new Promise((r,o)=>{n(),i=o,t=setTimeout(()=>{t=void 0,i=void 0,r()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const t=document.createElement("canvas"),i=t.getContext("2d"),n=t.height*(window.devicePixelRatio||1),r=i.createLinearGradient(0,0,0,n),o=1/(e.length-1);return e.forEach((a,l)=>{const d=l*o;r.addColorStop(d,a)}),r}renderBarWaveform(e,t,i,n){const r=e[0],o=e[1]||e[0],a=r.length,{width:l,height:d}=i.canvas,c=d/2,u=window.devicePixelRatio||1,m=t.barWidth?t.barWidth*u:1,v=t.barGap?t.barGap*u:t.barWidth?m/2:0,p=t.barRadius||0,y=l/(m+v)/a,x=p&&"roundRect"in i?"roundRect":"rect";i.beginPath();let b=0,f=0,C=0;for(let w=0;w<=a;w++){const S=Math.round(w*y);if(S>b){const L=Math.round(f*c*n),_=L+Math.round(C*c*n)||1;let A=c-L;t.barAlign==="top"?A=0:t.barAlign==="bottom"&&(A=d-_),i[x](b*(m+v),A,m,_,p),b=S,f=0,C=0}const E=Math.abs(r[w]||0),j=Math.abs(o[w]||0);E>f&&(f=E),j>C&&(C=j)}i.fill(),i.closePath()}renderLineWaveform(e,t,i,n){const r=o=>{const a=e[o]||e[0],l=a.length,{height:d}=i.canvas,c=d/2,u=i.canvas.width/l;i.moveTo(0,c);let m=0,v=0;for(let p=0;p<=l;p++){const y=Math.round(p*u);if(y>m){const b=c+(Math.round(v*c*n)||1)*(o===0?-1:1);i.lineTo(m,b),m=y,v=0}const x=Math.abs(a[p]||0);x>v&&(v=x)}i.lineTo(m,c)};i.beginPath(),r(0),r(1),i.fill(),i.closePath()}renderWaveform(e,t,i){if(i.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,i);let n=t.barHeight||1;if(t.normalize){const r=Array.from(e[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);n=r?1/r:1}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,i,n):this.renderLineWaveform(e,t,i,n)}renderSingleCanvas(e,t,i,n,r,o,a,l){const d=window.devicePixelRatio||1,c=document.createElement("canvas"),u=e[0].length;c.width=Math.round(i*(o-r)/u),c.height=n*d,c.style.width=`${Math.floor(c.width/d)}px`,c.style.height=`${n}px`,c.style.left=`${Math.floor(r*i/d/u)}px`,a.appendChild(c);const m=c.getContext("2d");if(this.renderWaveform(e.map(v=>v.slice(r,o)),t,m),c.width>0&&c.height>0){const v=c.cloneNode(),p=v.getContext("2d");p.drawImage(c,0,0),p.globalCompositeOperation="source-in",p.fillStyle=this.convertColorValues(t.progressColor),p.fillRect(0,0,c.width,c.height),l.appendChild(v)}}renderChannel(e,t,i){return k(this,void 0,void 0,function*(){const n=document.createElement("div"),r=this.getHeight(t.height);n.style.height=`${r}px`,this.canvasWrapper.style.minHeight=`${r}px`,this.canvasWrapper.appendChild(n);const o=n.cloneNode();this.progressWrapper.appendChild(o);const a=e[0].length,l=(b,f)=>{this.renderSingleCanvas(e,t,i,r,Math.max(0,b),Math.min(f,a),n,o)};if(!this.isScrollable)return void l(0,a);const{scrollLeft:d,scrollWidth:c,clientWidth:u}=this.scrollContainer,m=a/c;let v=Math.min(Z.MAX_CANVAS_WIDTH,u);if(t.barWidth||t.barGap){const b=t.barWidth||.5,f=b+(t.barGap||b/2);v%f!=0&&(v=Math.floor(v/f)*f)}const p=Math.floor(Math.abs(d)*m),y=Math.floor(p+v*m),x=y-p;x<=0||(l(p,y),yield Promise.all([(()=>k(this,void 0,void 0,function*(){if(p===0)return;const b=this.createDelay();for(let f=p;f>=0;f-=x)yield b(),l(Math.max(0,f-x),f)}))(),(()=>k(this,void 0,void 0,function*(){if(y===a)return;const b=this.createDelay();for(let f=y;f<a;f+=x)yield b(),l(f,Math.min(a,f+x))}))()]))})}render(e){return k(this,void 0,void 0,function*(){this.timeouts.forEach(a=>a()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const t=window.devicePixelRatio||1,i=this.scrollContainer.clientWidth,n=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=n>i;const r=this.options.fillParent&&!this.isScrollable,o=(r?i:n)*t;this.wrapper.style.width=r?"100%":`${n}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render");try{if(this.options.splitChannels)yield Promise.all(Array.from({length:e.numberOfChannels}).map((a,l)=>{var d;const c=Object.assign(Object.assign({},this.options),(d=this.options.splitChannels)===null||d===void 0?void 0:d[l]);return this.renderChannel([e.getChannelData(l)],c,o)}));else{const a=[e.getChannelData(0)];e.numberOfChannels>1&&a.push(e.getChannelData(1)),yield this.renderChannel(a,this.options,o)}}catch{return}this.emit("rendered")})}reRender(){if(!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:t}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:i}=this.progressWrapper.getBoundingClientRect();let n=i-t;n*=2,n=n<0?Math.floor(n):Math.ceil(n),n/=2,this.scrollContainer.scrollLeft+=n}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){const{scrollLeft:i,scrollWidth:n,clientWidth:r}=this.scrollContainer,o=e*n,a=i,l=i+r,d=r/2;if(this.isDragging)o+30>l?this.scrollContainer.scrollLeft+=30:o-30<a&&(this.scrollContainer.scrollLeft-=30);else{(o<a||o>l)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?d:0));const c=o-i-d;t&&this.options.autoCenter&&c>0&&(this.scrollContainer.scrollLeft+=Math.min(c,10))}{const c=this.scrollContainer.scrollLeft,u=c/n,m=(c+r)/n;this.emit("scroll",u,m)}}renderProgress(e,t){if(isNaN(e))return;const i=100*e;this.canvasWrapper.style.clipPath=`polygon(${i}% 0, 100% 0, 100% 100%, ${i}% 100%)`,this.progressWrapper.style.width=`${i}%`,this.cursor.style.left=`${i}%`,this.cursor.style.transform=`translateX(-${Math.round(i)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,i){return k(this,void 0,void 0,function*(){const n=this.canvasWrapper.querySelectorAll("canvas");if(!n.length)throw new Error("No waveform data");if(i==="dataURL"){const r=Array.from(n).map(o=>o.toDataURL(e,t));return Promise.resolve(r)}return Promise.all(Array.from(n).map(r=>new Promise((o,a)=>{r.toBlob(l=>{l?o(l):a(new Error("Could not export image"))},e,t)})))})}}Z.MAX_CANVAS_WIDTH=4e3;class Gt extends U{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class Kt extends U{constructor(e=new AudioContext){super(),this.bufferNode=null,this.autoplay=!1,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return k(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(t=>{if(t.status>=400)throw new Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.bufferNode.buffer=this.buffer,this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let t=this.playedDuration*this._playbackRate;t>=this.duration&&(t=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,t),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return k(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){var t,i;const n=e-this.currentTime;(t=this.bufferNode)===null||t===void 0||t.stop(this.audioContext.currentTime+n),(i=this.bufferNode)===null||i===void 0||i.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(e){return k(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){this.emit("seeking");const t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("timeupdate")}get duration(){var e;return((e=this.buffer)===null||e===void 0?void 0:e.duration)||0}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const t=this.buffer.numberOfChannels;for(let i=0;i<t;i++)e.push(this.buffer.getChannelData(i));return e}}const Yt={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};let ae=class Pe extends Xt{static create(e){return new Pe(e)}constructor(e){const t=e.media||(e.backend==="WebAudio"?new Kt:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.options=Object.assign({},Yt,e),this.timer=new Gt;const i=t?void 0:this.getMediaElement();this.renderer=new Z(this.options,i),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins(),Promise.resolve().then(()=>{this.emit("init");const n=this.options.url||this.getSrc()||"";(n||this.options.peaks&&this.options.duration)&&this.load(n,this.options.peaks,this.options.duration)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t)=>{const i=this.getDuration();this.emit("scroll",e*i,t*i)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{this.options.interact&&(this.renderer.renderProgress(t),clearTimeout(e),e=setTimeout(()=>{this.seekTo(t)},this.isPlaying()?0:200),this.emit("interaction",t*this.getDuration()),this.emit("drag",t))}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}setScrollTime(e){const t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,i,n){return k(this,void 0,void 0,function*(){if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!t&&!i){const o=a=>this.emit("loading",a);t=yield qt.fetchBlob(e,o,this.options.fetchParams)}this.setSrc(e,t);const r=n||this.getDuration()||(yield new Promise(o=>{this.onceMediaEvent("loadedmetadata",()=>o(this.getDuration()))}));if(i)this.decodedData=xe.createBuffer(i,r||0);else if(t){const o=yield t.arrayBuffer();this.decodedData=yield xe.decode(o,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,i){return k(this,void 0,void 0,function*(){yield this.loadAudio(e,void 0,t,i)})}loadBlob(e,t,i){return k(this,void 0,void 0,function*(){yield this.loadAudio("blob",e,t,i)})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:i=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const n=Math.min(e,this.decodedData.numberOfChannels),r=[];for(let o=0;o<n;o++){const a=this.decodedData.getChannelData(o),l=[],d=Math.round(a.length/t);for(let c=0;c<t;c++){const u=a.slice(c*d,(c+1)*d);let m=0;for(let v=0;v<u.length;v++){const p=u[v];Math.abs(p)>Math.abs(m)&&(m=p)}l.push(Math.round(m*i)/i)}r.push(l)}return r}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){super.setTime(e),this.updateProgress(e)}seekTo(e){const t=this.getDuration()*e;this.setTime(t)}playPause(){return k(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(e="image/png",t=1,i="dataURL"){return k(this,void 0,void 0,function*(){return this.renderer.exportImage(e,t,i)})}destroy(){this.emit("destroy"),this.plugins.forEach(e=>e.destroy()),this.subscriptions.forEach(e=>e()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}};ae.BasePlugin=class extends U{constructor(s){super(),this.subscriptions=[],this.options=s}onInit(){}_init(s){this.wavesurfer=s,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(s=>s())}},ae.dom=Ut;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Me(s,e){const[t,i]=g.useState(null),n=g.useMemo(()=>Object.entries(e).flat(),[e]);return g.useEffect(()=>{if(!s.current)return;const r=ae.create(Object.assign(Object.assign({},e),{container:s.current}));return i(r),()=>{r.destroy()}},[s,...n]),t}const Oe=/^on([A-Z])/,Jt=s=>Oe.test(s);function Zt(s,e){const t=g.useMemo(()=>Object.entries(e).flat(),[e]);g.useEffect(()=>{if(!s)return;const i=Object.entries(e);if(!i.length)return;const n=i.map(([r,o])=>{const a=r.replace(Oe,(l,d)=>d.toLowerCase());return s.on(a,(...l)=>o(s,...l))});return()=>{n.forEach(r=>r())}},[s,...t])}g.memo(s=>{const e=g.useRef(null),[t,i]=function(n){return g.useMemo(()=>{const r=Object.assign({},n),o=Object.assign({},n);for(const a in r)Jt(a)?delete r[a]:delete o[a];return[r,o]},[n])}(s);return Zt(Me(e,t),i),h.jsx("div",{ref:e})});function Qt(s){var{container:e}=s;const t=Me(e,function(n,r){var o={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&r.indexOf(a)<0&&(o[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(a=Object.getOwnPropertySymbols(n);l<a.length;l++)r.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(o[a[l]]=n[a[l]])}return o}(s,["container"])),i=function(n){const[r,o]=g.useState(!1),[a,l]=g.useState(!1),[d,c]=g.useState(0);return g.useEffect(()=>{if(!n)return;const u=[n.on("load",()=>{o(!1),l(!1),c(0)}),n.on("ready",()=>{o(!0),l(!1),c(0)}),n.on("play",()=>{l(!0)}),n.on("pause",()=>{l(!1)}),n.on("timeupdate",()=>{c(n.getCurrentTime())}),n.on("destroy",()=>{o(!1),l(!1)})];return()=>{u.forEach(m=>m())}},[n]),g.useMemo(()=>({isReady:r,isPlaying:a,currentTime:d}),[a,d])}(t);return g.useMemo(()=>Object.assign(Object.assign({},i),{wavesurfer:t}),[i,t])}let ei=class{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i==null?void 0:i.once){const n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}},ti=class extends ei{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}};function ze(s,e){const t=e.xmlns?document.createElementNS(e.xmlns,s):document.createElement(s);for(const[i,n]of Object.entries(e))if(i==="children")for(const[r,o]of Object.entries(e))typeof o=="string"?t.appendChild(document.createTextNode(o)):t.appendChild(ze(r,o));else i==="style"?Object.assign(t.style,n):i==="textContent"?t.textContent=n:t.setAttribute(i,n.toString());return t}function ie(s,e,t){const i=ze(s,e||{});return t==null||t.appendChild(i),i}const ii={height:20,formatTimeCallback:s=>s/60>1?`${Math.floor(s/60)}:${`${(s=Math.round(s%60))<10?"0":""}${s}`}`:`${Math.round(1e3*s)/1e3}`};let ni=class We extends ti{constructor(e){super(e||{}),this.options=Object.assign({},ii,e),this.timelineWrapper=this.initTimelineWrapper()}static create(e){return new We(e)}onInit(){var e;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");let t=this.wavesurfer.getWrapper();if(this.options.container instanceof HTMLElement)t=this.options.container;else if(typeof this.options.container=="string"){const i=document.querySelector(this.options.container);if(!i)throw Error(`No Timeline container found matching ${this.options.container}`);t=i}this.options.insertPosition?(t.firstElementChild||t).insertAdjacentElement(this.options.insertPosition,this.timelineWrapper):t.appendChild(this.timelineWrapper),this.subscriptions.push(this.wavesurfer.on("redraw",()=>this.initTimeline())),(!((e=this.wavesurfer)===null||e===void 0)&&e.getDuration()||this.options.duration)&&this.initTimeline()}destroy(){this.timelineWrapper.remove(),super.destroy()}initTimelineWrapper(){return ie("div",{part:"timeline-wrapper",style:{pointerEvents:"none"}})}defaultTimeInterval(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}defaultPrimaryLabelInterval(e){return e>=25?10:5*e>=25?6:4}defaultSecondaryLabelInterval(e){return e>=25?5:2}initTimeline(){var e,t,i,n,r,o,a;const l=(i=(t=(e=this.wavesurfer)===null||e===void 0?void 0:e.getDuration())!==null&&t!==void 0?t:this.options.duration)!==null&&i!==void 0?i:0,d=this.timelineWrapper.scrollWidth/l,c=(n=this.options.timeInterval)!==null&&n!==void 0?n:this.defaultTimeInterval(d),u=(r=this.options.primaryLabelInterval)!==null&&r!==void 0?r:this.defaultPrimaryLabelInterval(d),m=this.options.primaryLabelSpacing,v=(o=this.options.secondaryLabelInterval)!==null&&o!==void 0?o:this.defaultSecondaryLabelInterval(d),p=this.options.secondaryLabelSpacing,y=this.options.insertPosition==="beforebegin",x=ie("div",{style:Object.assign({height:`${this.options.height}px`,overflow:"hidden",fontSize:this.options.height/2+"px",whiteSpace:"nowrap"},y?{position:"absolute",top:"0",left:"0",right:"0",zIndex:"2"}:{position:"relative"})});x.setAttribute("part","timeline"),typeof this.options.style=="string"?x.setAttribute("style",x.getAttribute("style")+this.options.style):typeof this.options.style=="object"&&Object.assign(x.style,this.options.style);const b=ie("div",{style:{width:"0",height:"50%",display:"flex",flexDirection:"column",justifyContent:y?"flex-start":"flex-end",top:y?"0":"auto",bottom:y?"auto":"0",overflow:"visible",borderLeft:"1px solid currentColor",opacity:`${(a=this.options.secondaryLabelOpacity)!==null&&a!==void 0?a:.25}`,position:"absolute",zIndex:"1"}});for(let f=0,C=0;f<l;f+=c,C++){const w=b.cloneNode(),S=Math.round(100*f)/100%u==0||m&&C%m==0,E=Math.round(100*f)/100%v==0||p&&C%p==0;(S||E)&&(w.style.height="100%",w.style.textIndent="3px",w.textContent=this.options.formatTimeCallback(f),S&&(w.style.opacity="1"));const j=S?"primary":E?"secondary":"tick";w.setAttribute("part",`timeline-notch timeline-notch-${j}`),w.style.left=f*d+"px",x.appendChild(w)}this.timelineWrapper.innerHTML="",this.timelineWrapper.appendChild(x),this.emit("ready")}};class Fe{constructor(){this.listeners={}}on(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i==null?void 0:i.once){const n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class si extends Fe{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}function G(s,e,t,i,n=3,r=0){if(!s)return()=>{};let o=()=>{};const a=l=>{if(l.button!==r)return;l.preventDefault(),l.stopPropagation();let d=l.clientX,c=l.clientY,u=!1;const m=b=>{b.preventDefault(),b.stopPropagation();const f=b.clientX,C=b.clientY,w=f-d,S=C-c;if(u||Math.abs(w)>n||Math.abs(S)>n){const E=s.getBoundingClientRect(),{left:j,top:L}=E;u||(t==null||t(d-j,c-L),u=!0),e(w,S,f-j,C-L),d=f,c=C}},v=()=>{u&&(i==null||i()),o()},p=b=>{b.relatedTarget&&b.relatedTarget!==document.documentElement||v()},y=b=>{u&&(b.stopPropagation(),b.preventDefault())},x=b=>{u&&b.preventDefault()};document.addEventListener("pointermove",m),document.addEventListener("pointerup",v),document.addEventListener("pointerout",p),document.addEventListener("pointercancel",p),document.addEventListener("touchmove",x,{passive:!1}),document.addEventListener("click",y,{capture:!0}),o=()=>{document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",v),document.removeEventListener("pointerout",p),document.removeEventListener("pointercancel",p),document.removeEventListener("touchmove",x),setTimeout(()=>{document.removeEventListener("click",y,{capture:!0})},10)}};return s.addEventListener("pointerdown",a),()=>{o(),s.removeEventListener("pointerdown",a)}}function $e(s,e){const t=e.xmlns?document.createElementNS(e.xmlns,s):document.createElement(s);for(const[i,n]of Object.entries(e))if(i==="children")for(const[r,o]of Object.entries(e))typeof o=="string"?t.appendChild(document.createTextNode(o)):t.appendChild($e(r,o));else i==="style"?Object.assign(t.style,n):i==="textContent"?t.textContent=n:t.setAttribute(i,n.toString());return t}function H(s,e,t){const i=$e(s,e||{});return t==null||t.appendChild(i),i}class Ce extends Fe{constructor(e,t,i=0){var n,r,o,a,l,d,c,u;super(),this.totalDuration=t,this.numberOfChannels=i,this.minLength=0,this.maxLength=1/0,this.contentEditable=!1,this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((n=e.end)!==null&&n!==void 0?n:e.start),this.drag=(r=e.drag)===null||r===void 0||r,this.resize=(o=e.resize)===null||o===void 0||o,this.color=(a=e.color)!==null&&a!==void 0?a:"rgba(0, 0, 0, 0.1)",this.minLength=(l=e.minLength)!==null&&l!==void 0?l:this.minLength,this.maxLength=(d=e.maxLength)!==null&&d!==void 0?d:this.maxLength,this.channelIdx=(c=e.channelIdx)!==null&&c!==void 0?c:-1,this.contentEditable=(u=e.contentEditable)!==null&&u!==void 0?u:this.contentEditable,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){const e=this.start===this.end;this.element.setAttribute("part",`${e?"marker":"region"} ${this.id}`)}addResizeHandles(e){const t={position:"absolute",zIndex:"2",width:"6px",height:"100%",top:"0",cursor:"ew-resize",wordBreak:"keep-all"},i=H("div",{part:"region-handle region-handle-left",style:Object.assign(Object.assign({},t),{left:"0",borderLeft:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"2px 0 0 2px"})},e),n=H("div",{part:"region-handle region-handle-right",style:Object.assign(Object.assign({},t),{right:"0",borderRight:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"0 2px 2px 0"})},e);G(i,r=>this.onResize(r,"start"),()=>null,()=>this.onEndResizing(),1),G(n,r=>this.onResize(r,"end"),()=>null,()=>this.onEndResizing(),1)}removeResizeHandles(e){const t=e.querySelector('[part*="region-handle-left"]'),i=e.querySelector('[part*="region-handle-right"]');t&&e.removeChild(t),i&&e.removeChild(i)}initElement(){const e=this.start===this.end;let t=0,i=100;this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(i=100/this.numberOfChannels,t=i*this.channelIdx);const n=H("div",{style:{position:"absolute",top:`${t}%`,height:`${i}%`,backgroundColor:e?"none":this.color,borderLeft:e?"2px solid "+this.color:"none",borderRadius:"2px",boxSizing:"border-box",transition:"background-color 0.2s ease",cursor:this.drag?"grab":"default",pointerEvents:"all"}});return!e&&this.resize&&this.addResizeHandles(n),n}renderPosition(){const e=this.start/this.totalDuration,t=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*t+"%"}toggleCursor(e){var t;this.drag&&(!((t=this.element)===null||t===void 0)&&t.style)&&(this.element.style.cursor=e?"grabbing":"grab")}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",t=>this.emit("click",t)),e.addEventListener("mouseenter",t=>this.emit("over",t)),e.addEventListener("mouseleave",t=>this.emit("leave",t)),e.addEventListener("dblclick",t=>this.emit("dblclick",t)),e.addEventListener("pointerdown",()=>this.toggleCursor(!0)),e.addEventListener("pointerup",()=>this.toggleCursor(!1)),G(e,t=>this.onMove(t),()=>this.toggleCursor(!0),()=>{this.toggleCursor(!1),this.drag&&this.emit("update-end")}),this.contentEditable&&this.content&&(this.content.addEventListener("click",t=>this.onContentClick(t)),this.content.addEventListener("blur",()=>this.onContentBlur())))}_onUpdate(e,t){if(!this.element.parentElement)return;const{width:i}=this.element.parentElement.getBoundingClientRect(),n=e/i*this.totalDuration,r=t&&t!=="start"?this.start:this.start+n,o=t&&t!=="end"?this.end:this.end+n,a=o-r;r>=0&&o<=this.totalDuration&&r<=o&&a>=this.minLength&&a<=this.maxLength&&(this.start=r,this.end=o,this.renderPosition(),this.emit("update",t))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,t){this.resize&&this._onUpdate(e,t)}onEndResizing(){this.resize&&this.emit("update-end")}onContentClick(e){e.stopPropagation(),e.target.focus(),this.emit("click",e)}onContentBlur(){this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(){this.emit("play")}setContent(e){var t;if((t=this.content)===null||t===void 0||t.remove(),e){if(typeof e=="string"){const i=this.start===this.end;this.content=H("div",{style:{padding:`0.2em ${i?.2:.4}em`,display:"inline-block"},textContent:e})}else this.content=e;this.contentEditable&&(this.content.contentEditable="true"),this.content.setAttribute("part","region-content"),this.element.appendChild(this.content)}else this.content=void 0}setOptions(e){var t,i;if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const n=this.start===this.end;this.start=this.clampPosition((t=e.start)!==null&&t!==void 0?t:this.start),this.end=this.clampPosition((i=e.end)!==null&&i!==void 0?i:n?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const n=this.start===this.end;this.resize=e.resize,this.resize&&!n?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}}remove(){this.emit("remove"),this.element.remove(),this.element=null}}class de extends si{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new de(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",t=>{const i=this.regions.filter(n=>n.start<=t&&(n.end===n.start?n.start+.05:n.end)>=t);i.forEach(n=>{e.includes(n)||this.emit("region-in",n)}),e.forEach(n=>{i.includes(n)||this.emit("region-out",n)}),e=i}))}initRegionsContainer(){return H("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"3",pointerEvents:"none"}})}getRegions(){return this.regions}avoidOverlapping(e){if(!e.content)return;const t=e.content,i=t.getBoundingClientRect(),n=this.regions.map(r=>{if(r===e||!r.content)return 0;const o=r.content.getBoundingClientRect();return i.left<o.left+o.width&&o.left<i.left+i.width?o.height:0}).reduce((r,o)=>r+o,0);t.style.marginTop=`${n}px`}adjustScroll(e){var t,i;const n=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getWrapper())===null||i===void 0?void 0:i.parentElement;if(!n)return;const{clientWidth:r,scrollWidth:o}=n;if(o<=r)return;const a=n.getBoundingClientRect(),l=e.element.getBoundingClientRect(),d=l.left-a.left,c=l.right-a.left;d<0?n.scrollLeft+=d:c>r&&(n.scrollLeft+=c-r)}saveRegion(e){this.regionsContainer.appendChild(e.element),this.avoidOverlapping(e),this.regions.push(e);const t=[e.on("update",i=>{i||this.adjustScroll(e)}),e.on("update-end",()=>{this.avoidOverlapping(e),this.emit("region-updated",e)}),e.on("play",()=>{var i,n;(i=this.wavesurfer)===null||i===void 0||i.play(),(n=this.wavesurfer)===null||n===void 0||n.setTime(e.start)}),e.on("click",i=>{this.emit("region-clicked",e,i)}),e.on("dblclick",i=>{this.emit("region-double-clicked",e,i)}),e.once("remove",()=>{t.forEach(i=>i()),this.regions=this.regions.filter(i=>i!==e),this.emit("region-removed",e)})];this.subscriptions.push(...t),this.emit("region-created",e)}addRegion(e){var t,i;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const n=this.wavesurfer.getDuration(),r=(i=(t=this.wavesurfer)===null||t===void 0?void 0:t.getDecodedData())===null||i===void 0?void 0:i.numberOfChannels,o=new Ce(e,n,r);return n?this.saveRegion(o):this.subscriptions.push(this.wavesurfer.once("ready",a=>{o._setTotalDuration(a),this.saveRegion(o)})),o}enableDragSelection(e,t=3){var i;const n=(i=this.wavesurfer)===null||i===void 0?void 0:i.getWrapper();if(!(n&&n instanceof HTMLElement))return()=>{};let r=null,o=0;return G(n,(a,l,d)=>{r&&r._onUpdate(a,d>o?"end":"start")},a=>{var l,d;if(o=a,!this.wavesurfer)return;const c=this.wavesurfer.getDuration(),u=(d=(l=this.wavesurfer)===null||l===void 0?void 0:l.getDecodedData())===null||d===void 0?void 0:d.numberOfChannels,{width:m}=this.wavesurfer.getWrapper().getBoundingClientRect(),v=a/m*c,p=(a+5)/m*c;r=new Ce(Object.assign(Object.assign({},e),{start:v,end:p}),c,u),this.regionsContainer.appendChild(r.element)},()=>{r&&(this.saveRegion(r),r=null)},t)}clearRegions(){this.regions.forEach(e=>e.remove())}destroy(){this.clearRegions(),super.destroy(),this.regionsContainer.remove()}}const ri=({onClose:s})=>{const e=D(),t=e.colorScheme==="dark";return h.jsx(W,{variant:"subtle",sx:{fontWeight:400,color:e.colors.gray[5],"&:hover":{backgroundColor:t?"#2C2F3D":e.colors.gray[2]}},onClick:s,children:""})},X=({text:s,background:e})=>{const i=D().colorScheme==="dark";return h.jsx(F,{component:"span",sx:{padding:"1px 3px",borderRadius:"4px",fontWeight:500,background:i?e.dark:e.light},children:s})},ke=({color:s,text:e,onClick:t})=>h.jsx(W,{variant:"outline",onClick:t,sx:{color:s,padding:0,width:"130px",borderColor:s},children:e}),ne=({label:s})=>{const e=D(),t=e.colorScheme==="dark";return h.jsx(Y,{sx:{padding:"1px 9px",borderRadius:"7px",backgroundColor:t?"#307DC6":"#55AFFA",color:t?e.colors.gray[3]:"#FFFFFF"},children:s})},Ne=({title:s})=>{const e=D(),t=e.colorScheme==="dark";return h.jsx(ce,{sx:{padding:"20px",borderBottom:`1px solid ${t?"#373A40":e.colors.gray[3]}`},children:h.jsx(F,{size:16,fw:500,ta:"center",children:s})})},_e=g.forwardRef(({children:s,onClick:e},t)=>{const i=D(),n=i.colorScheme==="dark";return h.jsx(W,{variant:"subtle",onClick:e,ref:t,sx:{padding:0,height:"30px",minWidth:"30px",fontWeight:500,fontSize:"14px",borderRadius:"4px",color:n?i.colors.gray[3]:"black","&:hover":{backgroundColor:n?"#2C2F3D":i.colors.gray[2]}},children:s})}),Ae=({onClick:s,disabled:e=!1})=>{const t=D(),i=t.colorScheme==="dark";return B("keydown",n=>{n.code==="Enter"&&(n.preventDefault(),s())}),h.jsx(W,{onClick:s,sx:{width:"50px",fontWeight:500,alignSelf:"end",backgroundColor:i?"#29649B":t.colors.blue[5],"&:hover":{backgroundColor:i?"#1864AB":"#1C7ED6"}},disabled:e,children:h.jsx(R,{align:"center",gap:"2px",children:h.jsx(Ot,{size:14})})})},oi=[.5,1,1.5,2,3],ai=({setSpeed:s})=>{const e=D(),t=e.colorScheme==="dark",[i,n]=g.useState(1),r=o=>{n(o),s(o)};return h.jsxs(q,{shadow:"md",children:[h.jsx(q.Target,{children:h.jsxs(_e,{children:[i,"x"]})}),h.jsx(q.Dropdown,{sx:{gap:"1px",padding:"1px",borderRadius:"7px",backgroundColor:t?e.colors.darkBlack[3]:"white"},children:oi.map(o=>h.jsxs(q.Item,{sx:{padding:0,width:"45px",height:"35px",borderRadius:0,textAlign:"center",":hover":{backgroundColor:t?e.colors.darkBlack[5]:e.colors.gray[1]}},onClick:()=>r(o),children:[o,"x"]},o))})]})},se=[{icon:h.jsx(At,{size:16}),percent:0},{icon:h.jsx(It,{size:16}),percent:25},{icon:h.jsx(Nt,{size:16}),percent:50},{icon:h.jsx(_t,{size:16}),percent:100}],li=({setVolume:s})=>{const[e,t]=g.useState(3);g.useEffect(()=>{s(se[e].percent)},[s,e]);const i=()=>{e===se.length-1?t(0):t(n=>n+1)};return h.jsx(_e,{onClick:i,children:se[e].icon})},ci=z(({colors:s,colorScheme:e},{isPlaying:t})=>({root:{padding:0,height:"28px",minWidth:"28px",borderRadius:"4px",paddingLeft:t?"1px":"2px",backgroundColor:e==="dark"?"#307DC6":s.blue[5]}})),di=({isPlaying:s,togglePlaying:e})=>{const{classes:t}=ci({isPlaying:s});return h.jsx(W,{className:t.root,onClick:e,children:s?h.jsx(zt,{size:15}):h.jsx(Wt,{size:15})})},Se=({type:s,onClick:e})=>{const{colorScheme:t,colors:i}=D();return h.jsxs(tt,{onClick:e,sx:{flexDirection:"column",justifyContent:"start"},pos:"relative",children:[s==="back"?h.jsx($t,{color:t==="dark"?i.darkBlue[1]:i.blue[5],size:18}):h.jsx(Ft,{color:t==="dark"?i.darkBlue[1]:i.blue[5],size:18}),h.jsx(F,{fz:14,pos:"absolute",bottom:-7,color:t==="dark"?i.darkBlue[1]:i.blue[5],children:"2"})]})},hi=J(()=>{const{fragment:s,selectedLabel:e,setLabels:t,labels:i}=N,{colors:n,colorScheme:r}=D(),o=r==="dark",a=g.useRef(),l=g.useMemo(()=>ni.create({primaryLabelInterval:1,style:{color:n.gray[3],borderTop:`1px solid ${n.gray[3]}`,marginTop:"10px",fontSize:"12px"}}),[n]),d=g.useMemo(()=>de.create(),[]),{wavesurfer:c,isPlaying:u,currentTime:m}=Qt({container:a,url:s==null?void 0:s.url,waveColor:n.blue[3],progressColor:n.blue[6],height:70,width:"100%",plugins:g.useMemo(()=>[l,d],[l,d]),autoplay:!0}),v=()=>{t([...i,{start:m,end:m+c.getDuration()/10,label:e.label}]),d.addRegion({start:m,end:m+c.getDuration()/10,color:`${e.color}59`,content:e.label})},p=g.useCallback(()=>{c&&c.playPause()},[c]);B("keydown",b=>{b.code==="Space"&&b.shiftKey&&(b.preventDefault(),c&&c.playPause())});const y=b=>{c&&c.setVolume(b/100)},x=b=>{c&&c.setPlaybackRate(b)};return h.jsxs(M,{sx:{width:"100%",padding:"15px",alignItems:"center",borderRadius:"10px",backgroundColor:o?"#23252F":"#FFF",position:"relative",height:190},children:[h.jsxs(R,{justify:"space-between",w:"100%",sx:{borderBottom:`1px solid ${n.gray[3]}`,paddingBottom:"7px"},children:[h.jsxs(R,{gap:5,children:[h.jsx(Se,{type:"back",onClick:()=>{c&&c.skip(-2)}}),h.jsx(di,{isPlaying:u,togglePlaying:p}),h.jsx(Se,{type:"forward",onClick:()=>{c&&c.skip(2)}})]}),h.jsxs(R,{children:[h.jsx(li,{setVolume:y}),h.jsx(ai,{setSpeed:x})]})]}),h.jsx(ce,{w:"96%",pos:"absolute",top:55,children:h.jsx("div",{ref:a,style:{width:"100%",cursor:"pointer"},onDoubleClick:()=>(s==null?void 0:s.taskType)==="label"?v():{}})})]})}),ui=z(({colors:s,colorScheme:e},{instructionIsOpened:t})=>{const i=e==="dark";return{root:{right:0,height:"100%",position:"absolute",transition:"width 300ms",width:t?"50%":"100%",backgroundColor:i?s.darkBlack[6]:"white",borderLeft:`${t?"1px":"0px"} solid ${i?"#373A40":s.gray[3]}`},text:{fontSize:"20px",fontWeight:400,color:i?s.gray[3]:"#ADB5BD"}}}),pi=({instructionIsOpened:s})=>{const{classes:e}=ui({instructionIsOpened:s}),{t}=$();return h.jsx(Y,{className:e.root,children:h.jsx(F,{className:e.text,children:t("     ")})})},mi=z(()=>({root:{flex:1,marginBottom:"20px","& .mantine-Textarea-wrapper":{height:"75%"},"& .mantine-Textarea-input":{height:"75%"}}})),gi=J(()=>{const{fragment:s,setTrb:e}=N,{classes:t}=mi();return h.jsx(De,{autoFocus:!0,value:s==null?void 0:s.trb,onChange:i=>e(i.currentTarget.value),readOnly:(s==null?void 0:s.taskType)==="verify",onKeyDown:i=>{i.key==="Space"&&i.shiftKey&&i.preventDefault()},className:t.root})}),fi=({modalOpening:s})=>{const{setValid:e}=N,i=it().colorScheme==="dark",{t:n}=$();return B("keydown",r=>{r.key==="Enter"&&(r.preventDefault(),e(!0),s()),r.key==="Escape"&&r.ctrlKey&&(r.preventDefault(),e(!1),s())}),h.jsxs(R,{w:"100%",justify:"space-between",children:[h.jsx(ke,{text:n(" "),color:i?"#A64848":"#FF6B6B",onClick:()=>{e(!1),s()}}),h.jsx(ke,{text:n(" "),color:i?"#168A66":"#15B785",onClick:()=>{e(!0),s()}})]})},vi=()=>{const{t:s}=$();return[{key:"firstCommand",label:["Shift","Space"],text:s(" \\  ")},{key:"secondCommand",label:"Enter",text:s(" \\  ")},{key:"thirdCommand",label:["Esc","Ctrl"],text:s("  ")},{key:"forthCommand",label:"Esc",text:s("   ")},{key:"fifthCommand",label:["Shift","Space"],text:s("  (  )")}]},bi=()=>{const{t:s}=$();return[{key:"firstInstructionDescription",label:"123",text:s("      ( , ...)."),isCrossedOut:!0},{key:"secondInstructionDescription",label:"!?",text:h.jsxs(h.Fragment,{children:[s(""),"",h.jsx(X,{text:s(""),background:{light:"#FFD3D3",dark:"#613337"}}),"",s("     (  )   ,   .")]})},{key:"thirdInstructionDescription",label:"!?",text:h.jsxs(h.Fragment,{children:[s(""),"",h.jsx(X,{text:s(""),background:{light:"#B9EADB",dark:"#195446"}}),"",s("     ")," ",h.jsx("br",{}),s("(   )")]}),isCrossedOut:!0},{key:"fourthInstructionDescription",label:"!?",text:h.jsxs(h.Fragment,{children:[s(""),"",h.jsx(X,{text:s(""),background:{light:"#FFD3D3",dark:"#613337"}}),"",s("  ,           .")," "]}),isCrossedOut:!0},{key:"fifthInstructionDescription",label:"!?",text:h.jsxs(h.Fragment,{children:[s(""),"",h.jsx(X,{text:s(""),background:{light:"#FFD3D3",dark:"#613337"}}),"",s("       .    ,    .")]}),isCrossedOut:!0}]},yi={verify:"     ",transcribate:"    ",classify:"     ",label:"      "},xi=s=>yi[s],Ee={0:"#66D9E8",1:"#E599F7",2:"#91A7FF",3:"#8CE99A",4:"#FF6B6B",5:"#F1F3F5",6:"#FFF3BF"},he=()=>{const{setFragment:s,setLabels:e,setSelectedLabel:t,clearFragment:i}=N;return{getFragment:g.useCallback(()=>nt(()=>{e([]),t({label:"",color:""}),Ht().then(({data:r})=>{var o;s({id:r.task_id,trb:String(r.additional_params.trb),label_list:(o=r.additional_params.label_list)==null?void 0:o.map((a,l)=>({label:a,color:Ee[l]})),url:r.s3_path,taskType:r.task_type}),r.additional_params.label_list&&t({label:r.additional_params.label_list[0],color:Ee[0]})}).catch(()=>i())}),[e,t,s,i])}},wi=z(({colors:s})=>({container:{overflowX:"scroll",gap:15,padding:5,"::-webkit-scrollbar":{width:"0px"},alignItems:"center"},button:{height:"30px",width:"auto",borderRadius:"7px",border:`1px solid ${s.blue[3]}`,fontWeight:500,transition:"all 0.2s ease-out"},button_near_active:{height:"35px",width:"auto",borderRadius:"7px",border:`1px solid ${s.blue[4]}`,fontWeight:500,transition:"all 0.3s ease-out"},button_active:{height:"45px",width:"auto",borderRadius:"7px",border:`1px solid ${s.blue[9]}`,fontWeight:500}})),Ci=J(()=>{var a;const{classes:s}=wi(),{colors:e}=D(),{fragment:t,selectedLabel:i,setSelectedLabel:n}=N,r=g.useRef([]),o=g.useRef(null);return h.jsx("div",{children:h.jsx(ot,{ref:o,type:"never",children:h.jsx(R,{className:s.container,children:(a=t==null?void 0:t.label_list)==null?void 0:a.map(({label:l,color:d},c)=>h.jsx(W,{ref:u=>{r.current[c]=u},id:String(c),variant:"outline",sx:{border:`1px solid ${t.taskType==="label"?d:e.blue[5]}`,background:l===i.label?`${t.taskType==="label"?d:e.blue[5]}33`:"none",color:t.taskType==="classify"?e.blue[5]:d,"&:hover":{background:l===i.label?`${t.taskType==="label"?d:e.blue[5]}40`:`${t.taskType==="label"?d:e.blue[5]}1A`}},onClick:()=>n({label:l,color:d}),children:l},l))})})})}),ki=J(({instructionIsOpened:s,openClarifying:e})=>{const t=D(),i=t.colorScheme==="dark",{fragment:n,selectedLabel:r,labels:o,valid:a}=N,{t:l}=$(),{successNotification:d,errorNotification:c}=je(),{getFragment:u}=he(),m=async()=>{if(n)if(n.taskType==="classify"||n.taskType==="label")n.taskType==="classify"?(await ye(n.id,r.label),d(l(" !   !"))):(await Vt(n.id,Object.values(o.map(({start:p,end:y,label:x})=>({start:p,end:y,label:x})))),d(l(" !   !"))),u(),localStorage.setItem("wasOpened","true");else if(JSON.parse(localStorage.getItem("wasOpened")||"false")==="true")try{n&&(n.taskType==="verify"?(await oe(n.id,a),d(l(" !   !"))):n.taskType==="transcribate"&&(await re(n.id,String(n.trb)),d(l(" !   !")))),u(),localStorage.setItem("wasOpened","true")}catch{c(l("  "))}else e()},v=()=>{ye(n.id,null).then(()=>{d(l(" !   !")),u()})};return n?h.jsxs(M,{sx:{right:0,height:"100%",position:"absolute",transition:"width 300ms",width:s?"50%":"100%"},spacing:0,children:[h.jsx(Ne,{title:l(xi(n.taskType))}),h.jsx(M,{sx:{gap:0,width:"100%",height:"100%",borderStyle:"solid",borderWidth:s?"0 0 0 1px":"0px",borderColor:i?"#373A40":t.colors.gray[3]},children:h.jsxs(M,{sx:{height:"80%",alignSelf:"center",padding:"50px 0 30px",width:s?"90%":"60%"},children:[h.jsx(hi,{}),n.taskType==="transcribate"||n.taskType==="verify"?h.jsx(gi,{}):h.jsx(Y,{children:h.jsx(Ci,{})}),n.taskType==="verify"?h.jsx(fi,{modalOpening:JSON.parse(localStorage.getItem("wasOpened")||"false")?async()=>{try{n&&(n.taskType==="verify"?(await oe(n.id,a),d(l(" !   !"))):n.taskType==="transcribate"&&(await re(n.id,String(n.trb)),d(l(" !   !")))),u(),localStorage.setItem("wasOpened","true")}catch{c(l("  "))}}:()=>e()}):h.jsxs(R,{justify:n.taskType==="classify"?"space-between":"end",children:[n.taskType==="classify"&&h.jsx(W,{onClick:v,variant:"outline",color:"red",children:l("    ")}),h.jsx(Ae,{onClick:m})]})]})})]},n.id):h.jsx(pi,{instructionIsOpened:s})}),Si=({label:s,isCrossedOut:e,text:t})=>{const i=D(),n=i.colorScheme==="dark";return h.jsxs(R,{gap:20,align:"center",children:[h.jsx(Y,{sx:{position:"relative",height:"25px",minWidth:"33px",borderRadius:"7px",backgroundColor:n?"#307DC6":"#55AFFA",color:n?i.colors.gray[3]:"#FFFFFF","&:after":e?{content:'""',width:"100%",height:"2px",backgroundColor:"white",position:"absolute",left:0,top:"50%",transform:"translateY(-50%) rotate(35deg)"}:{}},children:s}),h.jsx(F,{size:14,component:"span",children:t})]})},Ei=({label:s,text:e})=>h.jsxs(R,{gap:"20px",children:[h.jsx(R,{miw:"140px",gap:"10px",justify:"center",children:typeof s=="string"?h.jsx(ne,{label:s}):h.jsxs(h.Fragment,{children:[h.jsx(ne,{label:s[0]}),"+",h.jsx(ne,{label:s[1]})]})}),h.jsx(F,{children:e})]}),ji=st({from:{transform:"translateX(-100%)"}}),Ti=({isOpened:s})=>{const{t:e}=$(),t=bi(),i=vi(),n=t.map(({key:o,text:a,label:l,isCrossedOut:d})=>h.jsx(Si,{text:a,label:l,isCrossedOut:d},o)),r=i.map(({key:o,text:a,label:l})=>h.jsx(Ei,{label:l,text:a},o));return h.jsxs(ce,{sx:{transition:"width 300ms",width:"50%",display:s?"block":"none",animation:`${ji} .3s 1`},children:[h.jsx(Ne,{title:e("")}),h.jsxs(M,{sx:{gap:"3vh",height:"100%",textWrap:"inherit",padding:"30px 40px 50px"},children:[h.jsx(M,{spacing:"1vh",children:n}),h.jsx(F,{fw:500,children:e(" :")}),h.jsx(M,{spacing:"18px",children:r})]})]})},Ri=z(({colorScheme:s,colors:e})=>{const t=s==="dark";return{root:{"& .mantine-Modal-header":{padding:"12px 20px",backgroundColor:t?e.darkBlack[6]:"white"},"& .mantine-Modal-title":{fontWeight:500},"& .mantine-Modal-body":{height:"150px",padding:"20px",backgroundColor:t?e.darkBlack[6]:"white"}},modalStack:{height:"100%",justifyContent:"space-between"},buttonsFlex:{gap:"20px",justifyContent:"end"}}}),Di=({opened:s,onClose:e})=>{const{classes:t}=Ri(),{t:i}=$(),{fragment:n,valid:r}=N,{successNotification:o,errorNotification:a}=je(),{getFragment:l}=he();B("keydown",c=>{c.code==="Escape"&&(c.preventDefault(),e())});const d=async()=>{try{n&&(n.taskType==="verify"?(await oe(n.id,r),o(i(" !   !"))):n.taskType==="transcribate"&&(await re(n.id,String(n.trb)),o(i(" !   !")))),e(),l(),localStorage.setItem("wasOpened","true")}catch{a(i("  "))}};return h.jsx(rt,{title:i("!"),centered:!0,opened:s,onClose:e,className:t.root,children:h.jsxs(M,{className:t.modalStack,children:[h.jsx(F,{children:i(",     ,        .   .")}),h.jsxs(R,{className:t.buttonsFlex,children:[h.jsx(ri,{onClose:e}),h.jsx(Ae,{onClick:d})]})]})})},Li=z(({colors:s,colorScheme:e})=>{const t=e==="dark";return{button:{width:"180px",fontWeight:500,fontSize:"14px",padding:"10px",color:t?s.gray[3]:"white",backgroundColor:t?"#29649B":s.blue[5],"&:hover":{backgroundColor:"#1C7ED6"}}}}),Pi=g.memo(({instructionIsOpened:s,toggleInstructionIsOpened:e})=>{const{classes:t}=Li(),{t:i}=$();return h.jsx(W,{className:t.button,onClick:e,children:i(s?" ":" ")})}),Mi=z(({colorScheme:s})=>({root:{gap:"30px",height:"100%"},buttonSkeleton:{width:"fit-content"},mainSkeleton:{width:"100%",height:"100%"},markup:{width:"100%",height:"100%",overflow:"hidden",alignSelf:"center",position:"relative",borderRadius:"10px",backgroundColor:s==="dark"?"#1C1E26":"white"}})),Oi=()=>{const{classes:s}=Mi(),{setFragment:e,clearFragment:t,setSelectedLabel:i}=N,[n,{open:r,close:o}]=ht(!1),[a,l]=dt({key:"Instruction",defaultValue:!0}),{getFragment:d}=he();return g.useEffect(()=>{t(),d()},[e,t,i,d]),h.jsxs(M,{className:s.root,children:[h.jsx(Pi,{instructionIsOpened:a,toggleInstructionIsOpened:()=>l(c=>!c)}),h.jsxs(R,{className:s.markup,children:[h.jsx(Ti,{isOpened:a}),h.jsx(ki,{instructionIsOpened:a,openClarifying:r}),h.jsx(Di,{opened:n,onClose:o})]})]})},Bi=()=>h.jsx(M,{sx:{gap:"20px",height:"100%",paddingTop:"25px"},children:h.jsx(Oi,{})});export{Bi as default};
